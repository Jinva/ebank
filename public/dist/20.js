webpackJsonp([20],{370:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{list:[],merchant:"",order_type:"",purse_type:"",user_type:"",payment:"",payments:"",amount_sum:"",keyword:{page:1,export:0,user_id:"",order_no:"",merchant_id:[],order_type:[],purse_type_id:[],user_type_id:[],pay_status:[],notify_status:[],refund_status:[],payment:[],date:[]},pay_status:["未支付","支付成功"],notify_status:["未通知","通知成功"],refund_status:["未退款","退款成功"]}},methods:{search:function(t){this.keyword.page=t,this.keyword.export=0,this.init()},exports:function(){this.keyword.export=1,this.init()},complete:function(t){var e=this;mdui.confirm("手动标记为支付成功并分发通知，是否收到款项需财务核实，点击【确定】继续","三方支付漏单/掉单补回",function(){e.$API.post("/order/complete",{id:t}).then(function(t){mdui.alert("操作完成，订单标记为已支付",function(){},{history:!1}),e.init()}).catch(function(t){})},function(){},{history:!1,confirmText:"确定",cancelText:"取消"})},notify:function(t){var e=this;mdui.confirm("异步通知会影响商户对支付的响应，可能造成多次结算等问题，知悉后点击【确定】继续","手动发起异步通知",function(){e.$API.post("/order/notify",{id:t}).then(function(t){mdui.alert("已重新分发通知任务",function(){},{history:!1}),e.init()}).catch(function(t){})},function(){},{history:!1,confirmText:"确定",cancelText:"取消"})},refund:function(t,e){var r=this;mdui.prompt("退款金额会返还到下单用户的现金钱包余额中，请在下方输入【退款金额】。注意：输入单位为分","订单总金额(分)："+e,function(e){e&&r.$API.post("/order/refund",{id:t,amount:e}).then(function(t){mdui.alert("退款成功，已完成系统到用户的转账操作，如产生奖励部分需手动冲正",function(){},{history:!1}),r.init()}).catch(function(t){})},function(){},{history:!1,confirmText:"确定",cancelText:"取消"})},init:function(){var t=this;t.$API.get("/order/index",t.keyword).then(function(e){t.list=e.list,t.merchant=e.merchant,t.purse_type=e.purse_type,t.user_type=e.user_type,t.order_type=e.order_type,t.payment=e.payment,t.payments=e.payments,t.amount_sum=e.amount_sum,t.keyword.export&&mdui.alert("可在左侧【导出任务】菜单查看任务状态并下载文件","已放入导出任务",function(){},{history:!1})}).catch(function(t){})}},mounted:function(){this.init()}}},371:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order_index"},[r("div",{staticClass:"typo",on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(1)}}},[r("blockquote",{staticClass:"blockquote_normal"},[r("p",[t._v("\n\t\t\t\t订单号："),r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.order_no,expression:"keyword.order_no"}],staticClass:"mdui-textfield-input input_normal",attrs:{type:"text"},domProps:{value:t.keyword.order_no},on:{input:function(e){e.target.composing||t.$set(t.keyword,"order_no",e.target.value)}}})]),t._v(" "),r("p",[t._v("\n\t\t\t\t下单用户ID："),r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.user_id,expression:"keyword.user_id"}],staticClass:"mdui-textfield-input input_normal",attrs:{type:"text"},domProps:{value:t.keyword.user_id},on:{input:function(e){e.target.composing||t.$set(t.keyword,"user_id",e.target.value)}}})]),t._v(" "),r("p",[t._v("\n\t\t\t\t日期筛选："),r("date-picker",{model:{value:t.keyword.date,callback:function(e){t.$set(t.keyword,"date",e)},expression:"keyword.date"}})],1),r("p",[t._v("\n\t\t\t\t商　　户：\n\t\t\t\t"),t._l(t.merchant,function(e,s){return r("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.merchant_id,expression:"keyword.merchant_id"}],attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.keyword.merchant_id)?t._i(t.keyword.merchant_id,s)>-1:t.keyword.merchant_id},on:{change:function(e){var r=t.keyword.merchant_id,n=e.target,a=!!n.checked;if(Array.isArray(r)){var o=s,i=t._i(r,o);n.checked?i<0&&t.$set(t.keyword,"merchant_id",r.concat([o])):i>-1&&t.$set(t.keyword,"merchant_id",r.slice(0,i).concat(r.slice(i+1)))}else t.$set(t.keyword,"merchant_id",a)}}}),t._v(" "),r("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])})],2),t._v(" "),r("p",[t._v("\n\t\t\t\t订单类型：\n\t\t\t\t"),t._l(t.order_type,function(e,s){return r("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.order_type,expression:"keyword.order_type"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.keyword.order_type)?t._i(t.keyword.order_type,e)>-1:t.keyword.order_type},on:{change:function(r){var s=t.keyword.order_type,n=r.target,a=!!n.checked;if(Array.isArray(s)){var o=e,i=t._i(s,o);n.checked?i<0&&t.$set(t.keyword,"order_type",s.concat([o])):i>-1&&t.$set(t.keyword,"order_type",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.keyword,"order_type",a)}}}),t._v(" "),r("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])})],2),t._v(" "),r("p",[t._v("\n\t\t\t\t订单状态：\n\t\t\t\t"),t._l(t.pay_status,function(e,s){return r("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.pay_status,expression:"keyword.pay_status"}],attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.keyword.pay_status)?t._i(t.keyword.pay_status,s)>-1:t.keyword.pay_status},on:{change:function(e){var r=t.keyword.pay_status,n=e.target,a=!!n.checked;if(Array.isArray(r)){var o=s,i=t._i(r,o);n.checked?i<0&&t.$set(t.keyword,"pay_status",r.concat([o])):i>-1&&t.$set(t.keyword,"pay_status",r.slice(0,i).concat(r.slice(i+1)))}else t.$set(t.keyword,"pay_status",a)}}}),t._v(" "),r("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])}),t._v(" "),t._l(t.notify_status,function(e,s){return r("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.notify_status,expression:"keyword.notify_status"}],attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.keyword.notify_status)?t._i(t.keyword.notify_status,s)>-1:t.keyword.notify_status},on:{change:function(e){var r=t.keyword.notify_status,n=e.target,a=!!n.checked;if(Array.isArray(r)){var o=s,i=t._i(r,o);n.checked?i<0&&t.$set(t.keyword,"notify_status",r.concat([o])):i>-1&&t.$set(t.keyword,"notify_status",r.slice(0,i).concat(r.slice(i+1)))}else t.$set(t.keyword,"notify_status",a)}}}),t._v(" "),r("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])}),t._v(" "),t._l(t.refund_status,function(e,s){return r("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.refund_status,expression:"keyword.refund_status"}],attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.keyword.refund_status)?t._i(t.keyword.refund_status,s)>-1:t.keyword.refund_status},on:{change:function(e){var r=t.keyword.refund_status,n=e.target,a=!!n.checked;if(Array.isArray(r)){var o=s,i=t._i(r,o);n.checked?i<0&&t.$set(t.keyword,"refund_status",r.concat([o])):i>-1&&t.$set(t.keyword,"refund_status",r.slice(0,i).concat(r.slice(i+1)))}else t.$set(t.keyword,"refund_status",a)}}}),t._v(" "),r("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])})],2),t._v(" "),r("p",[t._v("\n\t\t\t\t支付类型：\n\t\t\t\t"),t._l(t.payment,function(e,s){return r("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.payment,expression:"keyword.payment"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.keyword.payment)?t._i(t.keyword.payment,e)>-1:t.keyword.payment},on:{change:function(r){var s=t.keyword.payment,n=r.target,a=!!n.checked;if(Array.isArray(s)){var o=e,i=t._i(s,o);n.checked?i<0&&t.$set(t.keyword,"payment",s.concat([o])):i>-1&&t.$set(t.keyword,"payment",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.keyword,"payment",a)}}}),t._v(" "),r("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(t.payments[e]||e)+"\n\t\t\t\t")])})],2),t._v(" "),r("a",{staticClass:"mdui-btn mdui-ripple mdui-color-theme",on:{click:function(e){return t.search(1)}}},[r("i",{staticClass:"mdui-icon mdui-icon-left material-icons"},[t._v("search")]),t._v("搜索")]),t._v(" "),r("a",{staticClass:"mdui-btn mdui-ripple mdui-color-pink",on:{click:t.exports}},[r("i",{staticClass:"mdui-icon mdui-icon-left material-icons"},[t._v("file_upload")]),t._v("导出")])]),t._v(" "),r("blockquote",{staticClass:"blockquote_normal"},[t._v("\n\t\t\t支付金额统计(分)\n\t\t\t"),r("p",{staticStyle:{"line-height":"25px"}},t._l(t.amount_sum,function(e,s){return r("span",{staticClass:"mdui-m-r-3"},[t._v(t._s(t.payments[s]||s)+"："+t._s(e))])}),0)])]),t._v(" "),r("div",{staticClass:"mdui-table-fluid"},[r("table",{staticClass:"mdui-table mdui-table-hoverable"},[t._l(t.list.data,function(e,s,n){return[r("tbody",[r("tr",{staticClass:"mdui-color-grey-200"},[r("td",[t._v("订单金额(分)："),r("span",{staticStyle:{color:"#FE0016"},domProps:{textContent:t._s(e.amount)}})]),t._v(" "),r("td",[t._v("订单号："),r("span",{staticStyle:{color:"#FF6A00"},domProps:{textContent:t._s(e.order_no)}})]),t._v(" "),r("td",[t._v("商品名："),r("span",{staticStyle:{color:"#169320"},domProps:{textContent:t._s(e.product_name)}})])]),t._v(" "),r("tr",[r("td",[t._v("下单用户ID："),r("span",{domProps:{textContent:t._s(e.user_id)}})]),t._v(" "),r("td",[t._v("同步返回地址："),r("span",{domProps:{textContent:t._s(e.return_url)}})]),t._v(" "),r("td",[t._v("异步通知地址："),r("span",{domProps:{textContent:t._s(e.notify_url)}})])]),t._v(" "),r("tr",[r("td",[t._v("订单状态："),r("strong",[e.status?r("span",{staticClass:"mdui-text-color-green"},[t._v("订单有效")]):r("span",{staticClass:"mdui-text-color-grey"},[t._v("订单无效")])])]),t._v(" "),r("td",[t._v("下单时间："),r("span",{domProps:{textContent:t._s(e.created_at)}})]),t._v(" "),r("td",[t._v("下单商户："),r("span",{domProps:{textContent:t._s(t.merchant[e.merchant_id])}})])]),t._v(" "),r("tr",[r("td",[t._v("支付状态："),r("strong",[e.pay_status?r("span",{staticClass:"mdui-text-color-green"},[t._v("支付成功")]):r("span",{staticClass:"mdui-text-color-grey"},[t._v("未支付")])])]),t._v(" "),r("td",[t._v("支付时间："),r("span",{domProps:{textContent:t._s(e.pay_time)}})]),t._v(" "),r("td",t._l(e.payment,function(s,n){return r("span",[r("span",{staticClass:"mdui-text-color-teal-400"},[t._v(t._s(t.payments[s.type]||s.type))]),t._v(" "),r("span",{staticClass:"mdui-text-color-red-500"},[t._v("「"+t._s(s.amount)+"」")]),n+1<e.payment.length?r("span",[t._v("、")]):t._e()])}),0)]),t._v(" "),r("tr",[r("td",[t._v("通知状态："),r("strong",[e.notify_status?r("span",{staticClass:"mdui-text-color-green"},[t._v("通知成功")]):r("span",{staticClass:"mdui-text-color-grey"},[t._v("未通知")])])]),t._v(" "),r("td",[t._v("通知时间："),r("span",{domProps:{textContent:t._s(e.notify_time)}})]),t._v(" "),r("td",[t._v("备注："),r("span",{domProps:{textContent:t._s(e.remarks)}})])]),t._v(" "),r("tr",[r("td",[t._v("退款状态："),r("strong",[e.refund_status?r("span",{staticClass:"mdui-text-color-red-500"},[t._v("已退款")]):r("span",{staticClass:"mdui-text-color-grey"},[t._v("未退款")])])]),t._v(" "),r("td",[t._v("退款时间："),r("span",{domProps:{textContent:t._s(e.refund_time)}})]),t._v(" "),r("td",[1==e.status&&0==e.pay_status?r("a",{staticClass:"mdui-btn mdui-ripple mdui-color-blue-grey",on:{click:function(r){return t.complete(e.id)}}},[t._v("掉单补回")]):t._e(),t._v(" "),1==e.status&&1==e.pay_status&&0==e.refund_status?r("a",{staticClass:"mdui-btn mdui-ripple mdui-color-theme",on:{click:function(r){return t.notify(e.id)}}},[t._v("手动通知")]):t._e(),t._v(" "),1==e.status&&1==e.pay_status&&0==e.refund_status?r("a",{staticClass:"mdui-btn mdui-ripple mdui-color-red",on:{click:function(r){return t.refund(e.id,e.amount)}}},[t._v("订单退款")]):t._e()])])])]})],2)]),t._v(" "),r("div",{staticClass:"mdui-color-white footer"},[r("pagination",{attrs:{pageInfo:{total:t.list.total,current:t.list.current_page,pagenum:t.list.per_page,page:t.list.last_page,pagegroup:9,skin:"#2196F3"}},on:{change:t.search}})],1)])},staticRenderFns:[]}},400:function(t,e,r){var s=r(1)(r(370),r(371),!1,null,null,null);t.exports=s.exports}});